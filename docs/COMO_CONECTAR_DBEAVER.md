# üóÑÔ∏è Como Conectar no Banco de Dados usando DBeaver

## üìã Pr√©-requisitos

### **1. Instalar DBeaver**

1. Acesse: https://dbeaver.io/download/
2. Baixe a vers√£o **Community Edition** (gratuita)
3. Execute o instalador
4. Siga o assistente de instala√ß√£o (clique em "Next" at√© finalizar)
5. Marque a op√ß√£o **"Create Desktop Shortcut"** (Criar Atalho na √Årea de Trabalho)

‚úÖ **DBeaver instalado!**

---

### **2. Verificar se os SQL Servers est√£o Rodando**

‚ö†Ô∏è **IMPORTANTE:** O AppEAO usa **2 bancos de dados separados**:
- üîê **AppEAO_Auth** (porta 1433) - Autentica√ß√£o e usu√°rios
- üìä **AppEAO_Data** (porta 1434) - Dados de neg√≥cio

#### **Passo 1: Abrir Terminal**
- Pressione `Windows + R`
- Digite: `cmd`
- Pressione Enter

#### **Passo 2: Verificar Docker**
```bash
docker ps
```

**O que voc√™ deve ver:**
```
CONTAINER ID   IMAGE                                        NAMES                    PORTS
abc123def456   mcr.microsoft.com/mssql/server:2022-latest   appeao-sqlserver-auth    0.0.0.0:1433->1433/tcp
xyz789ghi012   mcr.microsoft.com/mssql/server:2022-latest   appeao-sqlserver-data    0.0.0.0:1434->1433/tcp
```

‚úÖ **Se aparecerem 2 containers:** Ambos SQL Servers est√£o rodando!  
‚ùå **Se estiver vazio:** Execute `docker-compose up -d` no diret√≥rio do projeto

---

## üîå Conectar no DBeaver - Passo a Passo

üìå **ATEN√á√ÉO:** Voc√™ precisar√° criar **2 conex√µes separadas** (uma para cada banco)

---

## üîê CONEX√ÉO 1: Banco de Autentica√ß√£o (AppEAO_Auth)

### **PASSO 1: Abrir DBeaver**

1. Clique no √≠cone do DBeaver na √°rea de trabalho ou menu iniciar
2. Na primeira vez, pode aparecer uma tela de boas-vindas
3. Clique em **"Close"** ou **"Fechar"**

---

### **PASSO 2: Criar Nova Conex√£o**

1. Na barra superior, clique em **"Database"** (Banco de Dados)
2. Clique em **"New Database Connection"** (Nova Conex√£o)
   - Ou use o atalho: `Ctrl + Shift + N`
   - Ou clique no √≠cone **"+"** na barra de ferramentas

---

### **PASSO 3: Selecionar SQL Server**

1. Na janela "Connect to a database", procure por **"SQL Server"**
   - Use a caixa de busca no topo
   - Digite: `sql server`

2. Clique no √≠cone **"SQL Server"** (logo azul com "SQL")

3. Clique no bot√£o **"Next"** (Pr√≥ximo)

---

### **PASSO 4: Configurar Conex√£o Auth - Aba "Main"**

Agora voc√™ ver√° a tela de configura√ß√£o. Preencha os campos:

#### **Connection name (Nome da Conex√£o):**
```
AppEAO - Auth
```

#### **Server Host (Host do Servidor):**
```
localhost
```

#### **Port (Porta):**
```
1433
```

#### **Database/Schema (Banco de Dados):**
```
AppEAO_Auth
```

#### **Authentication (Autentica√ß√£o):**
- Selecione: **"SQL Server Authentication"**

#### **User name (Nome de Usu√°rio):**
```
sa
```

#### **Password (Senha):**
```
YourStrong@Passw0rd
```

‚úÖ **Marque a caixa:** "Save password locally" (Salvar senha localmente)

---

### **PASSO 5: Testar Conex√£o**

1. Na parte inferior da janela, clique em **"Test Connection"** (Testar Conex√£o)

2. Se for a primeira vez:
   - Uma janela pedir√° para **baixar os drivers**
   - Clique em **"Download"** ou **"Baixar"**
   - Aguarde o download terminar (pode levar 1-2 minutos)

3. Ap√≥s o download:
   - Voc√™ ver√° uma mensagem: **"Connected"** ‚úÖ
   - Ou em portugu√™s: **"Conectado"**

‚ùå **Se der erro:**
- Verifique se o SQL Server est√° rodando: `docker ps`
- Verifique se digitou a senha corretamente
- Tente novamente

---

### **PASSO 6: Finalizar Conex√£o Auth**

1. Clique no bot√£o **"Finish"** (Finalizar)
2. A conex√£o aparecer√° no painel esquerdo (**Database Navigator**)

```
üìÅ AppEAO - Auth
   ‚îî‚îÄ‚îÄ üìÅ Databases
       ‚îî‚îÄ‚îÄ üìÅ AppEAO_Auth
           ‚îî‚îÄ‚îÄ üìÅ Schemas
               ‚îî‚îÄ‚îÄ üìÅ dbo
                   ‚îî‚îÄ‚îÄ üìÅ Tables
                       ‚îî‚îÄ‚îÄ üìä Users
```

‚úÖ **Primeira conex√£o criada com sucesso!**

---

## üìä CONEX√ÉO 2: Banco de Dados de Neg√≥cio (AppEAO_Data)

### **PASSO 1: Criar Segunda Conex√£o**

1. Na barra superior, clique em **"Database"** > **"New Database Connection"**
   - Ou use: `Ctrl + Shift + N`

2. Selecione **"SQL Server"** novamente

3. Clique em **"Next"**

---

### **PASSO 2: Configurar Conex√£o Data - Aba "Main"**

Preencha os campos para o segundo banco:

#### **Connection name (Nome da Conex√£o):**
```
AppEAO - Data
```

#### **Server Host:**
```
localhost
```

#### **Port (Porta):**
```
1434
```
‚ö†Ô∏è **ATEN√á√ÉO:** Porta diferente! √â **1434** para o banco de Data!

#### **Database/Schema:**
```
AppEAO_Data
```

#### **Authentication:**
- Selecione: **"SQL Server Authentication"**

#### **User name:**
```
sa
```

#### **Password:**
```
YourStrong@Passw0rd
```

‚úÖ **Marque:** "Save password locally"

---

### **PASSO 3: Testar Conex√£o Data**

1. Clique em **"Test Connection"**
2. Deve aparecer: **"Connected"** ‚úÖ
3. Clique em **"Finish"**

---

### **PASSO 4: Resultado Final**

Agora voc√™ ter√° **2 conex√µes** no Database Navigator:

```
üìÅ AppEAO - Auth (localhost:1433)
   ‚îî‚îÄ‚îÄ üìÅ Databases
       ‚îî‚îÄ‚îÄ üìÅ AppEAO_Auth
           ‚îî‚îÄ‚îÄ üìÅ dbo
               ‚îî‚îÄ‚îÄ üìÅ Tables
                   ‚îî‚îÄ‚îÄ üìä Users

üìÅ AppEAO - Data (localhost:1434)
   ‚îî‚îÄ‚îÄ üìÅ Databases
       ‚îî‚îÄ‚îÄ üìÅ AppEAO_Data
           ‚îî‚îÄ‚îÄ üìÅ dbo
               ‚îî‚îÄ‚îÄ üìÅ Tables
                   ‚îî‚îÄ‚îÄ (vazio por enquanto)
```

‚úÖ **Ambas as conex√µes criadas!**

---

## üìä Visualizar Dados da Tabela Users (Banco Auth)

### **M√©todo 1: Usando Interface Gr√°fica**

1. No painel esquerdo, expanda:
   ```
   AppEAO - Auth
   ‚îî‚îÄ‚îÄ Databases
       ‚îî‚îÄ‚îÄ AppEAO_Auth
           ‚îî‚îÄ‚îÄ Schemas
               ‚îî‚îÄ‚îÄ dbo
                   ‚îî‚îÄ‚îÄ Tables
   ```

2. Localize a tabela **"Users"**

3. **Clique com bot√£o direito** na tabela "Users"

4. Selecione **"View Data"** ou **"Ver Dados"**
   - Ou: **"Data" > "View Data"**

5. Uma aba ser√° aberta mostrando todos os registros

‚úÖ **Voc√™ ver√° as colunas:**
- Id
- Name
- Email
- PasswordHash
- Phone
- CreatedAt
- UpdatedAt
- IsActive

---

### **M√©todo 2: Usando SQL**

1. **Clique com bot√£o direito** na conex√£o **"AppEAO - Auth"**

2. Selecione **"SQL Editor"** > **"Open SQL Script"**
   - Ou pressione: `Ctrl + ]`

3. Digite a consulta SQL:

```sql
-- Ver todos os usu√°rios
SELECT 
    Id,
    Name,
    Email,
    Phone,
    CreatedAt,
    IsActive
FROM Users;
```

4. **Execute a consulta:**
   - Pressione `Ctrl + Enter`
   - Ou clique no bot√£o **"Execute SQL Statement"** (√≠cone de "play" laranja)

5. Os resultados aparecer√£o na parte inferior

---

## üóÑÔ∏è Entendendo os Dois Bancos

### **AppEAO_Auth (Porta 1433)**
**Prop√≥sito:** Gerenciar autentica√ß√£o e credenciais de usu√°rios

**Tabelas:**
- `Users` - Usu√°rios do sistema

**Quando usar:**
- Ver usu√°rios cadastrados
- Verificar emails
- Checar status de usu√°rios
- Debugar problemas de login

---

### **AppEAO_Data (Porta 1434)**
**Prop√≥sito:** Armazenar dados de neg√≥cio da aplica√ß√£o

**Tabelas:** (Futuras)
- `Profissionais` - Cadastro de profissionais
- `Servicos` - Servi√ßos oferecidos
- `Solicitacoes` - Solicita√ß√µes de trabalho
- `Avaliacoes` - Avalia√ß√µes e feedback

**Quando usar:**
- Ver profissionais cadastrados
- Gerenciar servi√ßos
- Acompanhar solicita√ß√µes

‚ö†Ô∏è **Nota:** Por enquanto, este banco est√° vazio. Ser√° usado no futuro.

---

## üîç Consultas √öteis (Banco Auth)

### **1. Contar Total de Usu√°rios**

```sql
SELECT COUNT(*) AS TotalUsuarios
FROM Users;
```

### **2. Ver Usu√°rios Ativos**

```sql
SELECT 
    Name,
    Email,
    CreatedAt
FROM Users
WHERE IsActive = 1
ORDER BY CreatedAt DESC;
```

### **3. Buscar Usu√°rio por Email**

```sql
SELECT 
    Id,
    Name,
    Email,
    Phone,
    CreatedAt
FROM Users
WHERE Email = 'seu@email.com';
```

### **4. Ver √öltimos 10 Usu√°rios Cadastrados**

```sql
SELECT TOP 10
    Name,
    Email,
    CreatedAt
FROM Users
ORDER BY CreatedAt DESC;
```

### **5. Ver Estat√≠sticas (usando a View criada)**

```sql
SELECT * FROM vw_UserStatistics;
```

---

## üõ†Ô∏è Opera√ß√µes Comuns

### **Adicionar Novo Usu√°rio Manualmente**

```sql
INSERT INTO Users (Id, Name, Email, PasswordHash, Phone, CreatedAt, IsActive)
VALUES (
    NEWID(),
    'Nome do Usu√°rio',
    'email@exemplo.com',
    '$2a$11$hashdaSenhaAqui',  -- Use a API para criar com hash correto
    '(11) 99999-9999',
    GETUTCDATE(),
    1
);
```

‚ö†Ô∏è **Aten√ß√£o:** √â melhor criar usu√°rios pela API para garantir que a senha seja criptografada corretamente!

---

### **Atualizar Dados de um Usu√°rio**

```sql
UPDATE Users
SET 
    Phone = '(11) 98888-8888',
    UpdatedAt = GETUTCDATE()
WHERE Email = 'email@exemplo.com';
```

---

### **Desativar um Usu√°rio (Soft Delete)**

```sql
UPDATE Users
SET 
    IsActive = 0,
    UpdatedAt = GETUTCDATE()
WHERE Email = 'email@exemplo.com';
```

---

### **Deletar um Usu√°rio (Permanente)**

```sql
DELETE FROM Users
WHERE Email = 'email@exemplo.com';
```

‚ö†Ô∏è **Cuidado:** Esta opera√ß√£o √© permanente e n√£o pode ser desfeita!

---

## üé® Personalizar DBeaver

### **Mudar Tema para Escuro**

1. Menu **"Window"** > **"Preferences"**
2. Procure por **"Appearance"**
3. Em **"Theme"**, selecione **"Dark"**
4. Clique **"Apply and Close"**

### **Aumentar Tamanho da Fonte**

1. Menu **"Window"** > **"Preferences"**
2. Procure por **"Fonts"**
3. Ajuste o tamanho desejado
4. Clique **"Apply and Close"**

---

## ‚ùì Troubleshooting (Resolu√ß√£o de Problemas)

### **Problema: "Cannot establish connection"**

**Solu√ß√£o:**

1. Verificar se SQL Server est√° rodando:
   ```bash
   docker ps
   ```

2. Se n√£o estiver, iniciar:
   ```bash
   docker-compose up -d
   ```

3. Aguardar 30 segundos e tentar conectar novamente

---

### **Problema: "Login failed for user 'sa'"**

**Poss√≠veis causas:**

1. **Senha incorreta**
   - Verifique: `YourStrong@Passw0rd` (com @ e mai√∫sculas)

2. **SQL Server ainda iniciando**
   - Aguarde mais 30 segundos
   - Tente novamente

---

### **Problema: "Driver not found"**

**Solu√ß√£o:**

1. Na tela de teste de conex√£o, clique em **"Download"**
2. Aguarde o download dos drivers
3. Tente conectar novamente

---

### **Problema: "Cannot connect to localhost:1433"**

**Solu√ß√£o:**

1. Verificar se Docker Desktop est√° rodando
2. Verificar se a porta est√° livre:
   ```bash
   netstat -ano | findstr :1433
   ```
3. Se necess√°rio, reiniciar Docker:
   ```bash
   docker-compose restart sqlserver
   ```

---

## üì∏ Resumo Visual

### **Dados de Conex√£o - Banco de Auth:**

| Campo | Valor |
|-------|-------|
| **Nome** | `AppEAO - Auth` |
| **Host** | `localhost` |
| **Porta** | `1433` |
| **Banco** | `AppEAO_Auth` |
| **Usu√°rio** | `sa` |
| **Senha** | `YourStrong@Passw0rd` |
| **Autentica√ß√£o** | SQL Server Authentication |

### **Dados de Conex√£o - Banco de Data:**

| Campo | Valor |
|-------|-------|
| **Nome** | `AppEAO - Data` |
| **Host** | `localhost` |
| **Porta** | `1434` ‚ö†Ô∏è |
| **Banco** | `AppEAO_Data` |
| **Usu√°rio** | `sa` |
| **Senha** | `YourStrong@Passw0rd` |
| **Autentica√ß√£o** | SQL Server Authentication |

### **Estrutura dos Bancos:**

**AppEAO_Auth (Autentica√ß√£o):**
```
AppEAO_Auth (Database)
‚îî‚îÄ‚îÄ dbo (Schema)
    ‚îî‚îÄ‚îÄ Tables
        ‚îî‚îÄ‚îÄ Users
            ‚îú‚îÄ‚îÄ Id (uniqueidentifier)
            ‚îú‚îÄ‚îÄ Name (nvarchar)
            ‚îú‚îÄ‚îÄ Email (nvarchar)
            ‚îú‚îÄ‚îÄ PasswordHash (nvarchar)
            ‚îú‚îÄ‚îÄ Phone (nvarchar)
            ‚îú‚îÄ‚îÄ CreatedAt (datetime2)
            ‚îú‚îÄ‚îÄ UpdatedAt (datetime2)
            ‚îî‚îÄ‚îÄ IsActive (bit)
```

**AppEAO_Data (Neg√≥cio - Futuro):**
```
AppEAO_Data (Database)
‚îî‚îÄ‚îÄ dbo (Schema)
    ‚îî‚îÄ‚îÄ Tables
        ‚îú‚îÄ‚îÄ Profissionais (futuro)
        ‚îú‚îÄ‚îÄ Servicos (futuro)
        ‚îú‚îÄ‚îÄ Solicitacoes (futuro)
        ‚îî‚îÄ‚îÄ Avaliacoes (futuro)
```

---

## üéØ Checklist de Sucesso

- [ ] DBeaver instalado
- [ ] SQL Servers rodando no Docker (2 containers)
- [ ] Conex√£o Auth criada (porta 1433)
- [ ] Conex√£o Data criada (porta 1434)
- [ ] Teste de ambas conex√µes bem-sucedido
- [ ] Tabela Users vis√≠vel no banco Auth
- [ ] Consegue executar consultas SQL

‚úÖ **Tudo OK? Voc√™ est√° pronto para trabalhar com os bancos de dados!**

---

## üîÑ Alternar Entre os Bancos

Para trabalhar com bancos diferentes:

1. No **Database Navigator** (painel esquerdo)
2. Clique na conex√£o desejada:
   - **AppEAO - Auth** ‚Üí Para ver usu√°rios
   - **AppEAO - Data** ‚Üí Para dados de neg√≥cio (futuro)
3. Expanda e navegue pelas tabelas

**Dica:** Voc√™ pode ter ambas as conex√µes abertas simultaneamente!

---

## üìö Recursos Adicionais

### **Documenta√ß√£o Oficial:**
- DBeaver: https://dbeaver.io/docs/
- SQL Server: https://learn.microsoft.com/sql/

### **Tutoriais em V√≠deo:**
- YouTube: "DBeaver Tutorial" (busque por v√≠deos em portugu√™s)

### **Atalhos √öteis no DBeaver:**
- `Ctrl + Enter` - Executar consulta SQL
- `Ctrl + ]` - Abrir novo script SQL
- `Ctrl + Shift + E` - Executar script completo
- `Ctrl + Space` - Auto-complete SQL
- `F3` - Abrir propriedades do objeto

---

---

## üèóÔ∏è Por Que Dois Bancos?

A separa√ß√£o em dois bancos de dados segue **boas pr√°ticas de arquitetura**:

### **Benef√≠cios:**

1. **Seguran√ßa** üîê
   - Dados sens√≠veis (senhas) isolados no banco Auth
   - Menor exposi√ß√£o de credenciais

2. **Escalabilidade** üìà
   - Bancos podem estar em servidores diferentes no futuro
   - Scaling independente

3. **Organiza√ß√£o** üìÅ
   - Auth separado de dados de neg√≥cio
   - Responsabilidades claras

4. **Performance** ‚ö°
   - √çndices e queries otimizados por tipo de dado
   - Menos concorr√™ncia

5. **Manuten√ß√£o** üõ†Ô∏è
   - Backup independente
   - Migrations separadas
   - Mais f√°cil gerenciar

---

**Criado para facilitar sua vida! üéâ**

Se tiver d√∫vidas, consulte:
- üìñ `README.md` - Vis√£o geral do projeto
- üìö `docs/INDICE.md` - √çndice de toda documenta√ß√£o
- üóÑÔ∏è `database/README.md` - Detalhes da arquitetura de bancos

